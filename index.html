<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="æºªçŸ³ - ä¸€ä¸ªä¼˜é›…çš„çº¯æ–‡å­—å†…å®¹åˆ†äº«å¹³å°ï¼Œåœ¨è¿™é‡Œåˆ†äº«ä½ çš„æ€æƒ³ä¸æ•…äº‹">
    <meta name="keywords" content="å†…å®¹åˆ†äº«, æ–‡å­—, å†™ä½œ, é˜…è¯», æ•…äº‹">
    <title>æºªçŸ³ - åˆ†äº«ä½ çš„æ€æƒ³</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;600;700&family=Inter:wght@300;400;500;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="index.css">
</head>

<body>
    <!-- èƒŒæ™¯è£…é¥° -->
    <div class="bg-gradient"></div>
    <div class="bg-orb bg-orb-1"></div>
    <div class="bg-orb bg-orb-2"></div>
    <div class="bg-orb bg-orb-3"></div>

    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="#" class="logo" id="logo">
                <span class="logo-icon">æºª</span>
                <span class="logo-text">æºªçŸ³</span>
            </a>
            <div class="nav-actions">
                <div class="search-box" id="searchBox">
                    <input type="text" placeholder="æœç´¢æ–‡ç« ..." id="searchInput">
                    <button class="search-btn" id="searchBtn">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- ä¸»å†…å®¹åŒº -->
    <main class="main-content">
        <!-- é¦–é¡µè§†å›¾ -->
        <section class="view" id="homeView">
            <!-- è‹±é›„åŒºåŸŸ -->
            <div class="hero">
                <h1 class="hero-title">åœ¨è¿™é‡Œï¼Œ<span class="gradient-text">é˜…è¯»ç²¾å½©å†…å®¹</span></h1>
                <p class="hero-subtitle">æºªçŸ³æ˜¯ä¸€ä¸ªä¼˜é›…çš„çº¯æ–‡å­—å†…å®¹åˆ†äº«å¹³å°ï¼Œè®©æ–‡å­—å›å½’æœ¬çœŸ</p>
            </div>

            <!-- æ–‡ç« åˆ—è¡¨ -->
            <div class="posts-section">
                <div class="section-header">
                    <h2 class="section-title">æœ€æ–°æ–‡ç« </h2>
                    <div class="filter-tabs">
                        <button class="filter-tab active" data-filter="all">å…¨éƒ¨</button>
                        <button class="filter-tab" data-filter="popular">çƒ­é—¨</button>
                        <button class="filter-tab" data-filter="recent">æœ€æ–°</button>
                    </div>
                </div>
                <div class="posts-grid" id="postsGrid">
                    <!-- åŠ¨æ€ç”Ÿæˆçš„æ–‡ç« å¡ç‰‡ -->
                </div>
                <div class="empty-state" id="emptyState">
                    <div class="empty-icon">ğŸ“–</div>
                    <h3>æš‚æ— æ–‡ç« </h3>
                    <p>æ•¬è¯·æœŸå¾…æ›´å¤šç²¾å½©å†…å®¹</p>
                </div>
            </div>
        </section>

        <!-- æ–‡ç« è¯¦æƒ…è§†å›¾ -->
        <section class="view hidden" id="postView">
            <article class="post-detail">
                <button class="back-btn" id="backBtn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="m15 18-6-6 6-6"></path>
                    </svg>
                    <span>è¿”å›</span>
                </button>
                <header class="post-header">
                    <h1 class="post-title" id="postTitle"></h1>
                    <div class="post-meta">
                        <span class="post-date" id="postDate"></span>
                        <span class="post-reading-time" id="postReadingTime"></span>
                    </div>
                </header>
                <div class="post-content" id="postContent"></div>
            </article>
        </section>
    </main>

    <!-- Toast é€šçŸ¥ -->
    <div class="toast-container" id="toastContainer"></div>

    <script>
        /**
         * æºªçŸ³ - å‰å°å±•ç¤º
         * ä»…å±•ç¤ºæ–‡ç« ï¼Œç®¡ç†åŠŸèƒ½è¯·è®¿é—® admin.html
         */
        const App = {
            posts: [],
            currentPostId: null,

            init() {
                this.loadPosts();
                this.bindEvents();
                this.renderPosts();
            },

            loadPosts() {
                const saved = localStorage.getItem('xishi_posts');
                if (saved) {
                    this.posts = JSON.parse(saved);
                } else {
                    // é»˜è®¤ç¤ºä¾‹æ–‡ç« 
                    this.posts = [
                        {
                            id: Date.now(),
                            title: 'æ¬¢è¿æ¥åˆ°æºªçŸ³',
                            content: 'æºªçŸ³æ˜¯ä¸€ä¸ªä¼˜é›…çš„çº¯æ–‡å­—å†…å®¹åˆ†äº«å¹³å°ã€‚åœ¨è¿™é‡Œï¼Œä½ å¯ä»¥é˜…è¯»ç²¾å½©çš„æ–‡ç« å’Œæ•…äº‹ã€‚\n\næˆ‘ä»¬ç›¸ä¿¡ï¼Œæœ€å¥½çš„å†…å®¹ä¸éœ€è¦åä¸½çš„è£…é¥°ï¼Œæ–‡å­—æœ¬èº«å°±æ˜¯æœ€æœ‰åŠ›é‡çš„è¡¨è¾¾æ–¹å¼ã€‚',
                            createdAt: Date.now(),
                            views: 128
                        },
                        {
                            id: Date.now() + 1,
                            title: 'å…³äºé˜…è¯»è¿™ä»¶äº‹',
                            content: 'é˜…è¯»æ˜¯ä¸€ç§ä¸ä½œè€…å¯¹è¯çš„æ–¹å¼ã€‚å½“æˆ‘ä»¬æ²‰æµ¸åœ¨æ–‡å­—ä¸­æ—¶ï¼Œæ—¶é—´ä»¿ä½›é™æ­¢ã€‚\n\næ¯ä¸€ç¯‡æ–‡ç« éƒ½æ˜¯ä¸€æ‰‡çª—ï¼Œè®©æˆ‘ä»¬çœ‹è§ä¸åŒçš„ä¸–ç•Œï¼Œä½“éªŒä¸åŒçš„äººç”Ÿã€‚\n\næ„¿ä½ åœ¨è¿™é‡Œæ‰¾åˆ°è§¦åŠ¨å¿ƒçµçš„æ–‡å­—ã€‚',
                            createdAt: Date.now() - 86400000,
                            views: 256
                        }
                    ];
                    this.savePosts();
                }
            },

            savePosts() {
                localStorage.setItem('xishi_posts', JSON.stringify(this.posts));
            },

            bindEvents() {
                // Logo - å›åˆ°é¦–é¡µ
                document.getElementById('logo').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.showView('homeView');
                });

                // æœç´¢
                document.getElementById('searchInput').addEventListener('input', (e) => {
                    this.searchPosts(e.target.value);
                });

                // ç­›é€‰æ ‡ç­¾
                document.querySelectorAll('.filter-tab').forEach(tab => {
                    tab.addEventListener('click', () => {
                        document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
                        tab.classList.add('active');
                        this.filterPosts(tab.dataset.filter);
                    });
                });

                // è¿”å›æŒ‰é’®
                document.getElementById('backBtn').addEventListener('click', () => {
                    this.showView('homeView');
                });
            },

            showView(viewId) {
                document.querySelectorAll('.view').forEach(view => {
                    view.classList.add('hidden');
                });
                document.getElementById(viewId).classList.remove('hidden');
                window.scrollTo(0, 0);
            },

            renderPosts(postsToRender = this.posts) {
                const grid = document.getElementById('postsGrid');
                const emptyState = document.getElementById('emptyState');

                if (postsToRender.length === 0) {
                    grid.innerHTML = '';
                    emptyState.classList.add('show');
                    return;
                }

                emptyState.classList.remove('show');
                grid.innerHTML = postsToRender.map(post => this.createPostCard(post)).join('');

                // ç»‘å®šå¡ç‰‡ç‚¹å‡»äº‹ä»¶
                grid.querySelectorAll('.post-card').forEach(card => {
                    card.addEventListener('click', () => {
                        this.viewPost(parseInt(card.dataset.id));
                    });
                });
            },

            createPostCard(post) {
                const date = new Date(post.createdAt).toLocaleDateString('zh-CN', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
                const excerpt = post.content.substring(0, 150) + (post.content.length > 150 ? '...' : '');
                const readingTime = Math.max(1, Math.ceil(post.content.length / 400));

                return `
                    <article class="post-card" data-id="${post.id}">
                        <h3 class="post-card-title">${this.escapeHtml(post.title)}</h3>
                        <p class="post-card-excerpt">${this.escapeHtml(excerpt)}</p>
                        <div class="post-card-meta">
                            <span>${date}</span>
                            <span>çº¦ ${readingTime} åˆ†é’Ÿé˜…è¯»</span>
                        </div>
                    </article>
                `;
            },

            viewPost(id) {
                const post = this.posts.find(p => p.id === id);
                if (!post) return;

                this.currentPostId = id;
                post.views = (post.views || 0) + 1;
                this.savePosts();

                document.getElementById('postTitle').textContent = post.title;
                document.getElementById('postContent').textContent = post.content;

                const date = new Date(post.createdAt).toLocaleDateString('zh-CN', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                document.getElementById('postDate').textContent = date;

                const readingTime = Math.max(1, Math.ceil(post.content.length / 400));
                document.getElementById('postReadingTime').textContent = `çº¦ ${readingTime} åˆ†é’Ÿé˜…è¯»`;

                this.showView('postView');
            },

            searchPosts(query) {
                if (!query.trim()) {
                    this.renderPosts();
                    return;
                }

                const filtered = this.posts.filter(post =>
                    post.title.toLowerCase().includes(query.toLowerCase()) ||
                    post.content.toLowerCase().includes(query.toLowerCase())
                );
                this.renderPosts(filtered);
            },

            filterPosts(filter) {
                let sorted = [...this.posts];
                switch (filter) {
                    case 'popular':
                        sorted.sort((a, b) => (b.views || 0) - (a.views || 0));
                        break;
                    case 'recent':
                        sorted.sort((a, b) => b.createdAt - a.createdAt);
                        break;
                    default:
                    // å…¨éƒ¨ä¿æŒé»˜è®¤é¡ºåº
                }
                this.renderPosts(sorted);
            },

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        };

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–åº”ç”¨
        document.addEventListener('DOMContentLoaded', () => {
            App.init();
        });
    </script>
</body>

</html>